<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SolarSanchay ‚Äì Haryana | Solar Savings Estimation Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body { background:#f5f7fb; }

.header {
  background:#fff;
  border-bottom:4px solid #0b5ed7;
  padding:12px 0;
}

.hero {
  background:linear-gradient(135deg,#0b5ed7,#084298);
  color:#fff;
  padding:25px;
  border-radius:10px;
  margin-bottom:25px;
}

.card { border-radius:10px; }

.mode-card {
  cursor:pointer;
  border:2px solid #dee2e6;
  transition:0.3s;
}
.mode-card.active {
  border-color:#0b5ed7;
  background:#e7f1ff;
}
.mode-card:hover {
  border-color:#0b5ed7;
  box-shadow:0 0 12px rgba(11,94,215,0.2);
}

.result-box {
  background:#e7f1ff;
  border-left:5px solid #0b5ed7;
  padding:20px;
  border-radius:8px;
}

footer {
  background:#fff;
  border-top:2px solid #dee2e6;
  margin-top:40px;
  padding:15px 0;
  font-size:14px;
}

.form-check-input {
  transform:scale(1.3);
}
</style>
</head>

<body>

<!-- ================= HEADER ================= -->
<div class="header">
  <div class="container d-flex align-items-center justify-content-between flex-wrap">
    <div class="d-flex align-items-center">
      <img src="assests/haryana-logo.jpg" style="height:65px;margin-right:15px;">
      <div>
        <h4 class="mb-0 fw-bold">SolarSanchay ‚Äì Haryana</h4>
        <small class="text-muted">Solar Savings Estimation Portal</small>
      </div>
    </div>
    <div class="text-end">
      <small class="text-muted d-block">Government of Haryana</small>
      <small class="text-muted">Powered by NIC, Kurukshetra</small>
    </div>
  </div>
</div>

<div class="container my-4">

<!-- HERO -->
<div class="hero">
  <h3>‚òÄÔ∏è SolarSanchay</h3>
  <p>Know how much money you saved using your solar system, based on actual electricity bill.</p>
</div>

<!-- MODE SELECTION -->
<div class="row mb-4">
  <div class="col-md-6">
    <div class="card mode-card active" id="manualCard" onclick="selectMode('manual')">
      <div class="card-body text-center">
        <div style="font-size:40px;">‚úçÔ∏è</div>
        <h5>Enter Bill Details</h5>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card mode-card" id="scanCard" onclick="selectMode('scan')">
      <div class="card-body text-center">
        <div style="font-size:40px;">üì∑</div>
        <h5>Scan Electricity Bill</h5>
        <small class="text-muted">Coming Soon</small>
      </div>
    </div>
  </div>
</div>

<!-- CONSUMER IDENTIFICATION -->
<div class="card p-3 mb-3">
  <h5>üîç Consumer Identification</h5>
  <div class="row">
    <div class="col-md-6">
      <label>Bill Number *</label>
      <input class="form-control" id="billNumber">
    </div>
    <div class="col-md-6">
      <label>Meter Number</label>
      <input class="form-control" id="meter">
    </div>
  </div>
  <div class="row mt-2">
    <div class="col-md-6">
      <label>Account Number</label>
      <input class="form-control" id="account">
    </div>
    <div class="col-md-6 d-flex align-items-end">
      <small class="text-muted">* Meter OR Account number required</small>
    </div>
  </div>
</div>

<!-- BILL PERIOD -->
<div class="card p-3 mb-3">
  <h5>üìÖ Bill Period</h5>
  <div class="row">
    <div class="col-md-6">
      <label>From</label>
      <input type="date" class="form-control" id="billFrom">
    </div>
    <div class="col-md-6">
      <label>To</label>
      <input type="date" class="form-control" id="billTo">
    </div>
  </div>
</div>

<!-- MANUAL SECTION -->
<div class="card p-3 mb-3" id="manualSection">
  <h5>‚ö° Consumption Details</h5>
  <div class="row">
    <div class="col-md-4">
      <label>Gross Units</label>
      <input class="form-control" id="gross">
    </div>
    <div class="col-md-4">
      <label>Import Units</label>
      <input class="form-control" id="import">
    </div>
    <div class="col-md-4">
      <label>Export Units</label>
      <input class="form-control" id="export">
    </div>
  </div>
  <div class="row mt-2">
    <div class="col-md-4">
      <label>Fixed Charges</label>
      <input class="form-control" id="fixed">
    </div>
    <div class="col-md-4">
      <label>Total Bill Amount</label>
      <input class="form-control" id="totalBill">
    </div>
    <div class="col-md-4">
      <label>Arrears / Late Fee</label>
      <input class="form-control" id="arrears" value="0">
    </div>
  </div>
</div>

<!-- EDIT -->
<div class="card p-3 mb-3 border-warning">
  <div class="form-check form-switch">
    <input class="form-check-input" type="checkbox" id="isEdit" onchange="toggleEditReason()">
    <label class="form-check-label fw-bold">Corrected / Revised Bill Entry</label>
  </div>
  <div id="editReasonBox" class="mt-2 d-none">
    <textarea class="form-control" id="editReason" placeholder="Reason for correction"></textarea>
  </div>
</div>

<!-- SAVE OPTION -->
<div class="card p-3 mb-3">
  <h5>üìÅ Record Preference</h5>
  <div class="form-check">
    <input class="form-check-input" type="radio" name="saveOption" value="no" checked>
    <label class="form-check-label">Result for this bill only</label>
  </div>
  <div class="form-check mt-2">
    <input class="form-check-input" type="radio" name="saveOption" value="yes">
    <label class="form-check-label">Save for future reference</label>
  </div>
</div>

<button class="btn btn-primary w-100 btn-lg" onclick="submitData()">üí∞ Calculate Solar Saving</button>

<div id="result" class="result-box mt-4 d-none"></div>

</div>

<!-- FOOTER -->
<footer>
  <div class="container d-flex justify-content-between flex-wrap">
    <div>
      <strong>Developed & Maintained by:</strong><br>
      National Informatics Centre (NIC), Kurukshetra
    </div>
    <div>
      <strong>Last Updated:</strong>
      <span id="lastModified"></span>
    </div>
  </div>
</footer>

<!-- ================= SCRIPT ================= -->
<script>
let selectedMode = "manual";

function selectMode(mode){
  selectedMode = mode;
  manualCard.classList.toggle("active", mode==="manual");
  scanCard.classList.toggle("active", mode==="scan");
}

function toggleEditReason(){
  editReasonBox.classList.toggle("d-none", !isEdit.checked);
}

async function submitData(){

  if(!billNumber.value.trim()){
    alert("Please enter Bill Number"); return;
  }
  if(!meter.value.trim() && !account.value.trim()){
    alert("Enter Meter or Account Number"); return;
  }

  const saveOption = document.querySelector('input[name="saveOption"]:checked').value;

  const payload = {
    mode: selectedMode,
    billNumber: billNumber.value,
    meter: meter.value,
    account: account.value,
    billFrom: billFrom.value,
    billTo: billTo.value,
    gross: gross.value,
    import: import.value,
    export: export.value,
    fixed: fixed.value,
    totalBill: totalBill.value,
    arrears: arrears.value,
    saveOption: saveOption,
    isEdit: isEdit.checked ? "yes" : "no",
    editReason: editReason.value
  };

  const res = await fetch("YOUR_N8N_WEBHOOK_URL",{
    method:"POST",
    headers:{ "Content-Type":"application/json"},
    body:JSON.stringify(payload)
  });

  const html = await res.text();
  result.classList.remove("d-none");
  result.innerHTML = html;
}

window.addEventListener("DOMContentLoaded",()=>{
  const lm = new Date(document.lastModified);
  lastModified.innerText = lm.toLocaleString("en-IN");
});
</script>

</body>
</html>
